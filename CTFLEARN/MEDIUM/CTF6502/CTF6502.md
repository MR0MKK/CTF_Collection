# PIN!

## Description

* This time it's hiding our flag! Let's travel back in time to the beginning of the home computer revolution, whip out our programming manual and get our hands dirty with some good old 6502-assembly.
Implement the missing opcode in the OPCODE_0x49-method and fix the machine code in the program-variable.
When you're done you should be able to read the flag in the memory dump at memory address 0x0040.
Good luck, I'll see you in the future!
(The Program.cs-file is attached. Run it any way you prefer. Or use .NET Fiddle to run it in your browser here: https://dotnetfiddle.net/VDGK8P)
* [Attachement](https://ctflearn.com/challenge/download/852)

## Solution

1. Trong đoạn code ban đầu, hàm OPCODE_0x49 
```
    public static byte OPCODE_0x49(byte value, byte accumulator) {
        return 0xFF;
    }
```
Trong trường hợp này, hàm OPCODE_0x49 trả về giá trị cố định là 0xFF cho mọi giá trị đầu vào. Điều này gây ra việc giải mã không chính xác và dẫn đến kết quả hiển thị không đúng.

Ta tìm giá trị XOR phù hợp để tìm flag. Sau khi ta bruceforce ta được giá trị đó là `0x08`

```
data=[0x4B,0x5C,0x4E,0x64,0x6D,0x69,0x7A,0x66,0x73,0x60,0x38,0x65,0x3B,0x57,0x6B,0x38,0x65,0x78,0x7D,0x7C,0x3B,0x7A,0x57,0x7A,0x3B,0x7E,0x38,0x64,0x7D,0x7C,0x39,0x38,0x66,0x75]
for j in range(0x00,0xFF):
    flag=""
    for i in data:
        flag+=chr(i^j)
    if "CTFlearn{" in flag:
        print(flag)
```

* Flag:

```
CTFlearn{h0m3_c0mput3r_r3v0lut10n}
```